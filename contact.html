<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contact</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex flex-col min-h-screen">
  <div class="flex flex-1">
    <!-- Sidebar -->
    <aside class="bg-gray-800 text-white w-64 hidden md:block">
      <div class="p-4 text-center border-b border-gray-700">
        <a href="index.html">
          <img src="panasonic-logo.png" alt="Panasonic Logo" class="mx-auto w-32" />
        </a>
      </div>
      <nav class="p-4 space-y-2">
        <a href="index.html" class="block px-4 py-2 rounded hover:bg-gray-700">Home</a>
        <a href="firmware-update.html" class="block px-4 py-2 rounded hover:bg-gray-700">BIOS Firmware Update</a>
        <a href="troubleshooting.html" class="block px-4 py-2 rounded hover:bg-gray-700">Troubleshooting</a>
        <a href="manual.html" class="block px-4 py-2 rounded hover:bg-gray-700">Manuals</a>
        <a href="driver.html" class="block px-4 py-2 rounded hover:bg-gray-700">Drivers</a>
        <a href="contact.html" class="block px-4 py-2 rounded hover:bg-gray-700">Contact</a>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="flex-1 p-6">
      <div class="md:hidden mb-4">
        <!-- Mobile menu -->
        <button id="menuToggle" class="text-gray-800 focus:outline-none">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
        <div id="mobileMenu" class="hidden bg-white mt-2 border rounded shadow">
          <a href="index.html" class="block px-4 py-2 hover:bg-gray-100">Home</a>
          <a href="firmware-update.html" class="block px-4 py-2 hover:bg-gray-100">BIOS Firmware Update</a>
          <a href="troubleshooting.html" class="block px-4 py-2 hover:bg-gray-100">Troubleshooting</a>
          <a href="manual.html" class="block px-4 py-2 hover:bg-gray-100">Manuals</a>
          <a href="driver.html" class="block px-4 py-2 hover:bg-gray-100">Drivers</a>
          <a href="contact.html" class="block px-4 py-2 hover:bg-gray-100">Contact</a>
        </div>
      </div>

      <h1 class="text-2xl font-bold mb-4">Contact Form</h1>
      <p class="mb-4">Please use the form below to request support.</p>

      <!-- Dynamic Form & Sheet from Google Apps Script -->
      <div id="formContainer" class="mb-10"></div>
      <div id="sheetContainer" class="mb-10"></div>
    </main>
  </div>
  <footer class="text-center text-sm text-gray-500 mt-auto p-4 border-t">
    &copy; 2025 Panasonic Support Team | All rights reserved.
  </footer>

  <!-- JavaScript: 從 Google Apps Script 載入設定 -->
  <script>
    fetch("https://script.google.com/macros/s/AKfycbyVN2e8Y3yl2udq7gLEqnBemrJ6Hel1KIh4P_4IQ5-xtPf8m3n0Ml-sYrApj3p_dS3b/exec")
      .then(res => res.json())
      .then(config => {
        // 插入表單按鈕
        document.getElementById("formContainer").innerHTML = `
          <a href="${config.formUrl}" target="_blank"
            class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded shadow">
            ➕ Click here to open the support form
          </a>
          <p class="text-sm text-gray-500 mt-2">* The form opens in a new tab. Sign-in may be required for file uploads.</p>
        `;

        // 插入試算表 iframe
        document.getElementById("sheetContainer").innerHTML = `
          <h2 class="text-xl font-semibold mb-2">Submitted Records</h2>
          <iframe src="${config.sheetUrl}" width="100%" height="600" frameborder="0"></iframe>
        `;
      });
  </script>
</body>
</html>
